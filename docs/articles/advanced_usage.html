<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Usage of pharmaRTF • pharmaRTF</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Usage of pharmaRTF">
<meta property="og:description" content="pharmaRTF">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pharmaRTF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pharmaRTF.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">pharmaRTF Vignettes</li>
    <li>
      <a href="../articles/advanced_usage.html">Advanced Usage of pharmaRTF</a>
    </li>
    <li>
      <a href="../articles/huxtable_tips.html">Huxtable Tips</a>
    </li>
    <li>
      <a href="../articles/tf_from_file.html">Sourcing Titles and Footnotes From External Files</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atorus-research/pharmaRTF/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced Usage of pharmaRTF</h1>
                        <h4 class="author">Mike Stackhouse</h4>
            
            <h4 class="date">2020-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/pharmaRTF/blob/master/vignettes/advanced_usage.Rmd"><code>vignettes/advanced_usage.Rmd</code></a></small>
      <div class="hidden name"><code>advanced_usage.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette will focus on a few more intricate features of the pharmaRTF package. After reviewing this document, you should have a good idea of how to get the most out of pharmaRTF. Specifically, this vignette covers:</p>
<ul>
<li>Understanding document orientation within pharmaRTF</li>
<li>Multi-level column headers</li>
<li>Minimizing cell padding</li>
<li>Setting spacing between column headers and titles</li>
<li>Split titles</li>
<li>Special titles/footnote formats</li>
</ul>
</div>
<div id="a-small-note" class="section level2">
<h2 class="hasAnchor">
<a href="#a-small-note" class="anchor"></a>A Small Note</h2>
<p>Some of the syntax we use throughout this document uses the <code>%&gt;%</code> pipe operator. This is to display support for a tidyverse style of coding. You can find the <code>%&gt;%</code> operator in the <a href="https://cran.r-project.org/package=magrittr/vignettes/magrittr.html">magittr</a> package.</p>
</div>
<div id="understanding-document-orientation-within-pharmartf" class="section level2">
<h2 class="hasAnchor">
<a href="#understanding-document-orientation-within-pharmartf" class="anchor"></a>Understanding Document Orientation Within pharmaRTF</h2>
<p>In development of this feature, we realized as a team that the orientation of an RTF document has a bit of room for confusion. This spawns from the fact that within Microsoft Word, orientation is automatically determined by the document height and width, despite there being a keyword within RTF syntax that specifies landscape orientation. That said, we believe the most intuitive way to set the orientation of a document is with a property function, which in pharmaRTF is simply <code><a href="../reference/orientation.html">orientation()</a></code>/<code><a href="../reference/orientation.html">set_orientation()</a></code>.</p>
<p>The default orientation of a <code>pharmaRTF</code> document is landscape, as this is typically what you would use on the clinical reports that the package is designed for. <code>orientation</code> is closely tied with the <code>page_size</code> attribute. When the orientation of an <code>rtf_doc</code> object is set to landscape, the height and width of the <code>pagesize</code> attribute will write out as specified in the object, with <code>height</code> writing to the height document property and <code>width</code> writing to the width property.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">ht</span> <span class="kw">&lt;-</span> <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/as_huxtable.html">as_hux</a></span>(<span class="no">iris</span>, <span class="kw">add_colnames</span><span class="kw">=</span><span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/width.html">set_width</a></span>(<span class="fl">1.2</span>)

<span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>)
<span class="fu"><a href="../reference/pagesize.html">pagesize</a></span>(<span class="no">doc</span>)
<span class="co">#&gt;  width height </span>
<span class="co">#&gt;   11.0    8.5</span></pre></body></html></div>
<p>When you switch the orientation to ‘portrait’, the height and width properties will not change. Rather, when the actual RTF document is written out, the height and width will be reversed, effectively flipping the document on its side.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Set orientation to portrait</span>
  <span class="fu"><a href="../reference/orientation.html">set_orientation</a></span>(<span class="st">'portrait'</span>)

<span class="co"># Page size does not change</span>
<span class="fu"><a href="../reference/pagesize.html">pagesize</a></span>(<span class="no">doc</span>)
<span class="co">#&gt;  width height </span>
<span class="co">#&gt;   11.0    8.5</span></pre></body></html></div>
<p>So why not switch the height and width properties in the object? This opens the door for inadvertent confusion. Consider the case where a user changes the orientation of the document. At that point, assume you switched the height and width. Next, the user manually sets height and width themselves. At this point, the change in orientation would be overridden by whatever height and width the user chooses manually. This is why we decided to only have the reversal happen at the time of writing the RTF code. Note that <strong>height and width will always align with the object default, which is landscape</strong>. But the document itself will write out with portrait orientation.</p>
<p>After changing the orientation, you can see that the height and the width have switched in the output document, and the document is in portrait orientation</p>
<p><img src="table5_img1.png" width="400px"></p>
</div>
<div id="multi-level-column-headers" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-level-column-headers" class="anchor"></a>Multi-level Column Headers</h2>
<p>A common requirement of tables is to have spanning column headers. When columns need to be grouped in presentation, this is common practice. This requires a combination of work within huxtable and pharmaRTF. The first thing you need to do is create your huxtable object. For more details on how to do this, see the <a href="https://atorus-research.github.io/pharmaRTF/huxtable_tips.html">huxtable tips vignette</a>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Create the column headers data frame</span>
<span class="no">column_headers</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">Species</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">"Species of Flower"</span>),
  <span class="kw">Sepal.Length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Sepal"</span>, <span class="st">"Length"</span>),
  <span class="kw">Sepal.Width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">"Width"</span>),
  <span class="kw">Petal.Length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Petal"</span>, <span class="st">"Length"</span>),
  <span class="kw">Petal.Width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">"Width"</span>),
  <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)

<span class="co"># Create the huxtable table</span>
<span class="no">ht</span> <span class="kw">&lt;-</span> <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/as_huxtable.html">as_hux</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">column_headers</span>, <span class="no">iris</span>)) <span class="kw">%&gt;%</span>
  <span class="co"># Merge the Sepal cell over the Length and Width</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/merge_cells.html">merge_cells</a></span>(<span class="fl">1</span>, <span class="fl">2</span>:<span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Merge the Petal cell over the Length and Width</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/merge_cells.html">merge_cells</a></span>(<span class="fl">1</span>, <span class="fl">4</span>:<span class="fl">5</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Align the top cells for both Sepal and Petal</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/align.html">set_align</a></span>(<span class="fl">1</span>,<span class="fl">2</span>, <span class="st">'center'</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/align.html">set_align</a></span>(<span class="fl">1</span>,<span class="fl">4</span>, <span class="st">'center'</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Bold all the column header rows</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/bold.html">set_bold</a></span>(<span class="fl">1</span>:<span class="fl">2</span>, <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">iris</span>), <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Bottom border on 1st column header row </span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/left_border.html">set_bottom_border</a></span>(<span class="fl">1</span>, <span class="fl">2</span>:<span class="fl">4</span>, <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Bottom border on 2nd row</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/left_border.html">set_bottom_border</a></span>(<span class="fl">2</span>, <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">iris</span>), <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Set the page width</span>
  <span class="kw pkg">huxtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/huxtable/man/width.html">set_width</a></span>(<span class="fl">1.5</span>)

<span class="no">ht</span>[<span class="fl">1</span>:<span class="fl">10</span>,]</pre></body></html></div>
<table class="table huxtable">
<col>
<col>
<col>
<col>
<col>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;"></td>
<td colspan="2" style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Sepal</td>
<td colspan="2" style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Petal</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Species of Flower</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Length</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Width</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Length</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Width</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5.1</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.5</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.2</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">4.9</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.2</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">4.7</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.2</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.3</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.2</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">4.6</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.1</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.5</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.2</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.6</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.2</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.9</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.7</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.4</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">4.6</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.3</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">setosa</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3.4</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1.5</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.2</td>
</tr>
</table>
<p>Once the huxtable table is created with your multiple rows of column headers, incorporating it into your <code>rtf_doc</code> object is simple. Just use the <code>header_rows</code> argument when creating your RTF doc.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>)

<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table6.rtf"</span>)</pre></body></html></div>
<p>Below you can see that the 2 rows of column headers have been pulled into the header of the document and are repeating from page to page.</p>
<p><img src="table6_img1.png" width="800px"></p>
<p>New in pharmaRTF v0.1.1, <code>header_rows</code> now additionally offers the capability to prevent column headers from being pulled into the RTF document header. You can do this as follows:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># Method 1</span>
<span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">0</span>)

<span class="co"># Method 2</span>
<span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/header_rows.html">set_header_rows</a></span>(<span class="fl">0</span>)

<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table6.rtf"</span>)</pre></body></html></div>
<p><img src="table6_img2.png" width="800px"></p>
</div>
<div id="minimizing-cell-padding" class="section level2">
<h2 class="hasAnchor">
<a href="#minimizing-cell-padding" class="anchor"></a>Minimizing Cell Padding</h2>
<p>An odd quirk of RTF documents is the method in which they do cell padding. The default output actually uses a minimal amount of cell padding, but when looking at your display, it may still be too large for your personal preference of the display. But fear not! We have a method to help minimize the cell padding further.</p>
<p>The root of the issue is that RTF documents have two methods for handling cell padding. You can read more about this within the Details section of the <code><a href="../reference/ignore_cell_padding.html">ignore_cell_padding()</a></code> function. From a user perspective, it is simply a matter of adding one more line into the creation of your <code>rtf_doc</code> object.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/ignore_cell_padding.html">set_ignore_cell_padding</a></span>(<span class="fl">TRUE</span>)

<span class="co"># Or avoiding piping</span>
<span class="fu"><a href="../reference/ignore_cell_padding.html">ignore_cell_padding</a></span>(<span class="no">doc</span>) <span class="kw">&lt;-</span> <span class="fl">TRUE</span>

<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table7.rtf"</span>)</pre></body></html></div>
<p><img src="table7_img1.png" width="800px"></p>
</div>
<div id="setting-spacing-between-column-headers-and-titles" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-spacing-between-column-headers-and-titles" class="anchor"></a>Setting Spacing Between Column Headers and Titles</h2>
<p>Depending your display, you may want to have a gap between your titles and the column headers, or potentially space below the column headers and the start of the body of the table. One way to deal with this could be to add blank title lines or blank rows to your table - but that would be a hacky fix and less than ideal. This is why the <code>column_header_buffer</code> attribute exists in the <code>rtf_doc</code> object.</p>
<p><code><a href="../reference/column_header_buffer.html">column_header_buffer()</a></code> sets the buffer of spaces you want above and below the column headers.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/ignore_cell_padding.html">set_ignore_cell_padding</a></span>(<span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/column_header_buffer.html">set_column_header_buffer</a></span>(<span class="kw">top</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">bottom</span><span class="kw">=</span><span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"The Iris Dataset"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">font_size</span><span class="kw">=</span><span class="fl">20</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table8.rtf"</span>)</pre></body></html></div>
<p><img src="table8_img1.png" width="800px"></p>
</div>
<div id="split-titles" class="section level2">
<h2 class="hasAnchor">
<a href="#split-titles" class="anchor"></a>Split Titles</h2>
<p>Very often, we have tiles in clinical reports where there’s text that flushes left and right on the same line. pharmaRTF has a method to handle this within the <code>hf_line</code> object for titles and footnotes. <code>hf_line</code> objects have two spaces available within the <code>text</code> element:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">'Text1'</span>, <span class="st">'Text2'</span>)
<span class="co">#&gt; $text</span>
<span class="co">#&gt; [1] "Text1" "Text2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"align")</span>
<span class="co">#&gt; [1] "center"</span>
<span class="co">#&gt; attr(,"bold")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"italic")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"font")</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; attr(,"font_size")</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; attr(,"index")</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "hf_line"</span></pre></body></html></div>
<p>When the alignment is set to center, left, or right, these elements will simply concatenate. But when the alignment is set to ‘split’, the first text alignment will align on the left and the second on the right. This enables you to do those split titles and footnotes that you will often see within reports.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"I'm on the left"</span>, <span class="st">"I'm on the right"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">align</span><span class="kw">=</span><span class="st">'split'</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table9.rtf"</span>)</pre></body></html></div>
<p><img src="table9_img1.png" width="800px"></p>
</div>
<div id="special-titlefootnote-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#special-titlefootnote-formats" class="anchor"></a>Special Title/Footnote Formats</h2>
<p>The <code>hf_line</code> object has three keywords that trigger special behavior within titles and footnotes. These are:</p>
<ul>
<li>PAGE_FORMAT:</li>
<li>DATE_FORMAT:</li>
<li>FILE_PATH:</li>
</ul>
<p>When the text of a title/footnote <strong>starts with</strong> these keywords (note that it <em>must start</em> with this text), it triggers a special action. The text can either be in the first or second text element. Each one of these warrants some further explanation on their own.</p>
<div id="page_format" class="section level3">
<h3 class="hasAnchor">
<a href="#page_format" class="anchor"></a>PAGE_FORMAT:</h3>
<p>The <code>PAGE_FORMAT:</code> keyword triggers page numbering within a title or a footnote. This format can display both the current page and the total number of pages in the document. The user has full control over how this display happens, except for the fact that the current page must come first. Adding total pages is optional, but it has to be after the current page.</p>
<p>To add the page numbers into your display, you simply specify the keyword within the text element of an <code>hf_line</code> object, followed by your desired format. Enter <code>%s</code> where you want the page numbers to display. For example, let’s say you want to specify a page format like <code>Page 1 of 12</code>. To do this in your title or footnote, you would enter:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">hf_line('PAGE_FORMAT: Page %s of %s")</pre></body></html></div>
<p>Similarly, let’s say you wanted you page numbering to look like <code>1 | 5</code>:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">hf_line('PAGE_FORMAT: %s | %s")</pre></body></html></div>
<p>Or what if you just wanted <code>Page 5</code>?</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">hf_line('PAGE_FORMAT: Page %s")</pre></body></html></div>
<p>Whatever text you specify, the first occurrence of <code>%s</code> will be replaced with the current page, and the second occurrence will be replaced with the total. Looking at how this appears in the display:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"PAGE_FORMAT: Page %s of %s"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">align</span><span class="kw">=</span><span class="st">'right'</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table10.rtf"</span>)</pre></body></html></div>
<p><img src="table10_img1.png" width="800px"></p>
<p>This also works within split titles:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"Text on the left"</span>, <span class="st">"PAGE_FORMAT: Page %s of %s"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">align</span><span class="kw">=</span><span class="st">'split'</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table11.rtf"</span>)</pre></body></html></div>
<p><img src="table11_img1.png" width="800px"></p>
</div>
<div id="date_format" class="section level3">
<h3 class="hasAnchor">
<a href="#date_format" class="anchor"></a>DATE_FORMAT:</h3>
<p>Another standard practice is to include the run time of a document within the report, perhaps in a footnote. The DATE_FORMAT: keyword allows you to do this, writing the program execution time while the RTF document is being written out.</p>
<p>Date formats are specified using the standard R date formatting tokens. A full list of those tokens and their meaning can be found <a href="https://www.stat.berkeley.edu/~s133/dates.html">here</a>. Similar to PAGE_FORMAT:, as the user, you have full control over how the date is specified, and can include any other text you desire within the string.</p>
<p><em>NOTE: Date-times displayed will be in UTC. We have not yet added the capability to display the time within a specified locale.</em></p>
<p>As a practical example, consider entering an ISO-8601 complaint date-time:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"DATE_FORMAT: %Y-%m-%dT%H:%M:%S"</span>)</pre></body></html></div>
<p>Viewing this within a display, we can see that the time decodes properly.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"Text on the left"</span>, <span class="st">"DATE_FORMAT: %Y-%m-%dT%H:%M:%S"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">align</span><span class="kw">=</span><span class="st">'split'</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table12.rtf"</span>)</pre></body></html></div>
<p><img src="table12_img1.png" width="800px"></p>
<p>The formats have more flexibility as well, including display day of the week, full months, etc.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"Text on the left"</span>, <span class="st">"DATE_FORMAT: Document run on %H:%M %A, %B %d, %Y"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">align</span><span class="kw">=</span><span class="st">'split'</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table13.rtf"</span>)</pre></body></html></div>
<p><img src="table13_img1.png" width="800px"></p>
</div>
<div id="file_path" class="section level3">
<h3 class="hasAnchor">
<a href="#file_path" class="anchor"></a>FILE_PATH:</h3>
<p>The last of the special formats is FILE_PATH:. This keyword allows you to display the location of the executing R script automatically. This allows traceability of the display to the originating file, which can be desirable in many processes. That said, there’s a bit of nuance to the functionality of the is keyword.</p>
<p>The location of an executing R script is not as intuitive as it may seem. This is because there are multiple ways that an R script can be executed:</p>
<ul>
<li>Executed in R via the <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> command</li>
<li>Executed via the <code>Rscript</code> command through the command line</li>
<li>Executed interactively</li>
</ul>
<p>The file path will be determined in the above hierarchy. The only two options above that can return an actual file path are the <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> command and running via <code>Rscript</code>. When a file is run interactively, there is no guarantee of the executing files location - because the code is detached from the actual file. Therefore, in these cases, the text <code>&lt;run_interactively&gt;</code> will be returned.</p>
<p>Using the FILE_PATH: keyword, simply use the token <code>%s</code> to specify where you want the file path to appear. Like the other keywords, you may also include other text in the output string.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span><span class="kw">=</span><span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_titles_footnotes.html">add_titles</a></span>(<span class="fu"><a href="../reference/hf_line.html">hf_line</a></span>(<span class="st">"Text on the left"</span>, <span class="st">"FILE_PATH: Run from: %s"</span>, <span class="kw">bold</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">align</span><span class="kw">=</span><span class="st">'split'</span>))


<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table14.rtf"</span>)</pre></body></html></div>
<p><img src="table14_img1.png" width="800px"></p>
<p>As an example of a populated path:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">'file_path_example.r'</span>)</pre></body></html></div>
<p><img src="table15_img1.png" width="800px"></p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>If you have not already reviewed them, be sure to check out our other vignettes!</p>
<ul>
<li>To pick up the basics of using pharmaRTF, see <code><a href="../articles/pharmaRTF.html">vignette("pharmaRTF")</a></code>
</li>
<li>To learn tips and tricks for using huxtable with pharmaRTF, see <code><a href="../articles/huxtable_tips.html">vignette("huxtable_tips")</a></code>
</li>
<li>To learn more advanced usage of pharmaRTF, see <code><a href="../articles/advanced_usage.html">vignette("advanced_usage")</a></code>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eli Miller, Ashley Tarasiewicz, Michael Stackhouse.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
