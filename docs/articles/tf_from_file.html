<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sourcing Titles and Footnotes From External Files • pharmaRTF</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sourcing Titles and Footnotes From External Files">
<meta property="og:description" content="pharmaRTF">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-165685385-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165685385-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pharmaRTF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pharmaRTF.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">pharmaRTF Vignettes</li>
    <li>
      <a href="../articles/advanced_usage.html">Advanced Usage of pharmaRTF</a>
    </li>
    <li>
      <a href="../articles/huxtable_tips.html">Huxtable Tips</a>
    </li>
    <li>
      <a href="../articles/tf_from_file.html">Sourcing Titles and Footnotes From External Files</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atorus-research/pharmaRTF/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tf_from_file_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sourcing Titles and Footnotes From External Files</h1>
                        <h4 class="author">Mike Stackhouse</h4>
            
            <h4 class="date">2021-03-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/pharmaRTF/blob/master/vignettes/tf_from_file.Rmd"><code>vignettes/tf_from_file.Rmd</code></a></small>
      <div class="hidden name"><code>tf_from_file.Rmd</code></div>

    </div>

    
    
<p><em>We recommend that before reviewing this vignette, you review the <a href="https://atorus-research.github.io/pharmaRTF/articles/pharmaRTF.html">basics of pharmaRTF</a> and <a href="https://atorus-research.github.io/pharmaRTF/articles/advanced_usage.html">the more advanced features</a>.</em></p>
<div id="working-pharmartf-into-your-process" class="section level2">
<h2 class="hasAnchor">
<a href="#working-pharmartf-into-your-process" class="anchor"></a>Working pharmaRTF Into Your Process</h2>
<p>In this vignette, we will take you through some final features of pharmaRTF to help tie together how this package can centralize titles and footnotes within your organization, and show you the tools you need to embed this into your own internal process.</p>
<p>Being able to specify everything directly in a program is useful. For adhoc tables or to quickly put together an output, keeping everything central and in one spot is nice. But in a mature process, companies typically have a strategy to centralize the assignment of titles and footnotes. Keeping all of your titles and footnotes in one place has many advantages. You can global replace changes that impact numerous outputs. You can keep separate repetitive text instead of repeating it for each table. Updates take place in one file instead of having to open each individual impacted program. In short, centralizing this process is highly desirable within an organization.</p>
<p>pharmaRTF has the tools you need to make this process simple, and this comes from the function <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code>. This function allows you to import your titles and footnotes from a data frame. That data frame can either come directly from your R session, or you can build a custom reader function to import the data from an external file. So let’s take a look.</p>
</div>
<div id="a-small-note" class="section level2">
<h2 class="hasAnchor">
<a href="#a-small-note" class="anchor"></a>A Small Note</h2>
<p>Some of the syntax we use throughout this document uses the <code>%&gt;%</code> pipe operator. This is to display support for a tidyverse style of coding. You can find the <code>%&gt;%</code> operator in the <a href="https://cran.r-project.org/package=magrittr/vignettes/magrittr.html">magittr</a> package.</p>
</div>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How It Works</h2>
<p>The idea behind <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code> is simply that there is a set of expectations of what the data looks like that flows into the function. What that data looks like within an external file is irrelevant, as long as it can be transformed to meet the needs of <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code> on the way in. This is possible because of the <code>reader</code> parameter. The <code>reader</code> parameter is just some function that returns a data frame, and that data frame must be compliant with the required variables and types expected by <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code>. Those variables, types, and requirements are as follows.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Column.Types</th>
<th align="left">Required</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">type</td>
<td align="left">character</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">text1</td>
<td align="left">character</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">text2</td>
<td align="left">character</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">align</td>
<td align="left">character</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">bold</td>
<td align="left">logical</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">italic</td>
<td align="left">logical</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">font</td>
<td align="left">character</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">font_size</td>
<td align="left">numeric</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">index</td>
<td align="left">numeric</td>
<td align="left">No</td>
</tr>
</tbody>
</table>
<p>These variables and types should all look familiar because they’re exactly what’s required for the object <code>hf_line</code>. In fact, <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code> simply takes this data and applies the <code><a href="../reference/add_titles_footnotes.html">add_titles()</a></code> and <code><a href="../reference/add_titles_footnotes.html">add_footnotes()</a></code> function to the <code>rtf_doc</code> object to attach titles and footnotes.</p>
<p><code>type</code> and <code>text1</code> are the only required values and this is because <code>titles_and_foonotes_from_df()</code> needs to know where to attach the text, and needs to have text to attach. For variables that aren’t required, they may be omitted from the data returned by the reader function and the default values from the <code>hf_line</code> object will be used.</p>
</div>
<div id="custom-reader-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-reader-functions" class="anchor"></a>Custom Reader Functions</h2>
<p>The entire concept behind <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code> is allowing the freedom of creating your own process. By allowing the user to pass in a custom reader function to the <code>reader</code> parameter, the source of given titles and footnotes can be anything the user wants. You could read from flat text, CSV, Excel, Access, any remote file that R can process and return a data frame meeting the above requirements is on the table.</p>
<p>With this in mind, let’s consider a simple example. Assume that I have the excel file <code>titles.xlsx</code>. This file looks as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">table_number</th>
<th align="right">index</th>
<th align="left">type</th>
<th align="left">text1</th>
<th align="left">text2</th>
<th align="left">align</th>
<th align="left">bold</th>
<th align="left">italic</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">14-2.01</td>
<td align="right">1</td>
<td align="left">title</td>
<td align="left">Protocol: CDISCPILOT01</td>
<td align="left">PAGE_FORMAT: Page %s of %s</td>
<td align="left">split</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-2.01</td>
<td align="right">2</td>
<td align="left">title</td>
<td align="left">Population: Intent-to-Treat</td>
<td align="left">NA</td>
<td align="left">left</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">14-2.01</td>
<td align="right">3</td>
<td align="left">title</td>
<td align="left">Table 14-2.01</td>
<td align="left">NA</td>
<td align="left">center</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-2.01</td>
<td align="right">4</td>
<td align="left">title</td>
<td align="left">Summary of Demographic and Baseline Characteristics</td>
<td align="left">NA</td>
<td align="left">center</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">14-2.01</td>
<td align="right">1</td>
<td align="left">footnote</td>
<td align="left">[1] P-values are results of ANOVA treatment group comparison for continuous variable and Pearson’s chisquare test for categorical variables.</td>
<td align="left">NA</td>
<td align="left">left</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-2.01</td>
<td align="right">2</td>
<td align="left">footnote</td>
<td align="left">NOTE: Duration of disease is computed as months between date of enrollment and date of onset of the first definite symptoms of Alzheimer’s disease.</td>
<td align="left">NA</td>
<td align="left">left</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">14-2.01</td>
<td align="right">3</td>
<td align="left">footnote</td>
<td align="left">FILE_PATH: Source: %s</td>
<td align="left">DATE_FORMAT: %H:%M %A, %B %d, %Y</td>
<td align="left">split</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-4.01</td>
<td align="right">1</td>
<td align="left">title</td>
<td align="left">Protocol: CDISCPILOT01</td>
<td align="left">PAGE_FORMAT: Page %s of %s</td>
<td align="left">split</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">14-4.01</td>
<td align="right">2</td>
<td align="left">title</td>
<td align="left">Population: Safety</td>
<td align="left">NA</td>
<td align="left">left</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-4.01</td>
<td align="right">3</td>
<td align="left">title</td>
<td align="left">Table 14-4.01</td>
<td align="left">NA</td>
<td align="left">center</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">14-4.01</td>
<td align="right">4</td>
<td align="left">title</td>
<td align="left">Summary of Planned Exposure to Study Drug, as of End of Study</td>
<td align="left">NA</td>
<td align="left">center</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-4.01</td>
<td align="right">1</td>
<td align="left">footnote</td>
<td align="left">[1] Includes completers and early terminators.</td>
<td align="left">NA</td>
<td align="left">left</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">14-4.01</td>
<td align="right">2</td>
<td align="left">footnote</td>
<td align="left">[2] End of Study refers to week 26/Early Termination.</td>
<td align="left">NA</td>
<td align="left">left</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">14-4.01</td>
<td align="right">3</td>
<td align="left">footnote</td>
<td align="left">FILE_PATH: Source: %s</td>
<td align="left">DATE_FORMAT: %H:%M %A, %B %d, %Y</td>
<td align="left">split</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>(For more information about the special text fields you see here, see our <a href="https://atorus-research.github.io/pharmaRTF/articles/advanced_usage.html">advanced usage</a> vignette)</p>
<p>Here I have everything I need to generate my titles. I just need to make sure of two things:</p>
<ul>
<li>My column types read in appropriately</li>
<li>When I read the data, I filter to the appropriate table</li>
</ul>
<p>So overall this will be a pretty simple function. Let’s create it.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">example_custom_reader</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">...</span>, <span class="no">table_number</span><span class="kw">=</span><span class="kw">NULL</span>) {

  <span class="co"># If a column isn't populated then the type may be guessed wrong so force it</span>
  <span class="no">col_types</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'text'</span>, <span class="st">'numeric'</span>, <span class="st">'text'</span>, <span class="st">'text'</span>, <span class="st">'text'</span>, <span class="st">'text'</span>, <span class="st">'logical'</span>, <span class="st">'logical'</span>)
  <span class="co"># pass through arguments from ...</span>
  <span class="no">df</span> <span class="kw">&lt;-</span> <span class="kw pkg">readxl</span><span class="kw ns">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span>(<span class="no">...</span>, <span class="kw">col_types</span><span class="kw">=</span><span class="no">col_types</span>)

  <span class="co"># Subset and return that dataframe</span>
  <span class="no">df</span>[<span class="no">df</span>$<span class="no">table_number</span><span class="kw">==</span><span class="no">table_number</span>, !<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">df</span>) <span class="kw">==</span> <span class="st">'table_number'</span>]
}</pre></body></html></div>
<p>Within a few steps I have everything I need:</p>
<ul>
<li>I use <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">readxl::read_excel()</a></code> to import the data from the excel file</li>
<li>I filter the data to just contain rows associated with whatever table I specify</li>
<li>I remove the <code>table_number</code> column and just keep the variables that need to be sent to <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code>
</li>
</ul>
<p>Note that here I use the <code>...</code> parameter. This is because</p>
<ol style="list-style-type: lower-alpha">
<li>the <code>from.file</code> parameter is passed forward into the reader function</li>
<li>the <code>...</code> option on <code>titles_and_foonotes_from_df()</code> is also passed forward, allowing you to pass whatever arguments necessary from the <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code> call into your custom reader.</li>
</ol>
<p>With this function now available, let’s see what the function returns.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu">example_custom_reader</span>(<span class="st">'titles.xlsx'</span>, <span class="kw">table_number</span> <span class="kw">=</span> <span class="st">'14-2.01'</span>)
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   index type    text1                          text2          align bold  italic</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                          &lt;chr&gt;          &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; </span>
<span class="co">#&gt; 1     1 title   Protocol: CDISCPILOT01         PAGE_FORMAT: … split TRUE  TRUE  </span>
<span class="co">#&gt; 2     2 title   Population: Intent-to-Treat    &lt;NA&gt;           left  TRUE  TRUE  </span>
<span class="co">#&gt; 3     3 title   Table 14-2.01                  &lt;NA&gt;           cent… TRUE  TRUE  </span>
<span class="co">#&gt; 4     4 title   Summary of Demographic and Ba… &lt;NA&gt;           cent… TRUE  TRUE  </span>
<span class="co">#&gt; 5     1 footno… [1] P-values are results of A… &lt;NA&gt;           left  FALSE TRUE  </span>
<span class="co">#&gt; 6     2 footno… NOTE: Duration of disease is … &lt;NA&gt;           left  FALSE TRUE  </span>
<span class="co">#&gt; 7     3 footno… FILE_PATH: Source: %s          DATE_FORMAT: … split FALSE TRUE</span></pre></body></html></div>
<p>Here can see the data frame that the function processes and returns. In this example, the data processing was very simple - but in a more advanced case this function could read from multiple sheets, merge in default titles and footnotes, read from different data sources - whatever suits your process.</p>
</div>
<div id="putting-it-together" class="section level2">
<h2 class="hasAnchor">
<a href="#putting-it-together" class="anchor"></a>Putting It Together</h2>
<p>Now with an understanding of how a custom reader function works, let’s tie it all together. Let’s assume that our table has been programmed, and that the huxtable table is ready in our session (see the <a href="https://atorus-research.github.io/pharmaRTF/articles/huxtable_tips.html">huxtable tips vignette</a> to for tips on how to prepare your table). The huxtable table is our session looks like this:</p>
<table class="table huxtable">
<col style="width: 36%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<tr>
<td style="vertical-align: bottom; text-align: center; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: bold;"></td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: bold;"></td>
<td colspan="3" style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Completers at Week 24</td>
<td colspan="3" style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Safety Population [1]</td>
</tr>
<tr>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;"></td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;"></td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Placebo\line (N=60)</td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Xanomeline\line Low Dose\line (N=28)</td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Xanomeline\line High Dose\line (N=30)</td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Placebo\line (N=86)</td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Xanomeline\line Low Dose\line (N=84)</td>
<td style="vertical-align: bottom; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: bold;">Xanomeline\line High Dose\line (N=84)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Average daily dose (mg)</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">n</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   60     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   28     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   30     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   86     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   84     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   84     </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Mean</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   77.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   71.6   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">SD</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.00  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.00  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.58  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.00  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.00  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    8.11  </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Median</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   76.9   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   75.1   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Min</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   76.1   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Max</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   78.6   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   78.6   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Cumulative dose at end of study [2]</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">n</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   60     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   28     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   30     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   86     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   84     </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   84     </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Mean</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 9918.6   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">14089.5   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 5347.3   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 7551.0   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">SD</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.00  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">  603.84  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">  481.01  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.00  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 3680.35  </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 5531.04  </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Median</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 9936.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">14080.5   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 4455.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 5778.0   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Min</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"> 7884.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">12960.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">  108.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">   54.0   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">Max</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">11448.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">15417.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">    0.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">11448.0   </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;">15417.0   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 0pt 6pt 0pt 6pt; font-weight: normal;"></td>
</tr>
</table>
<p><em>Note: The data here comes from the CDISC Pilot, which you can read about <a href="https://bitbucket.cdisc.org/projects/CED/repos/sdtm-adam-pilot-project/raw/sdtmadampilotprojectreport.pdf?at=refs%2Fheads%2Fmaster">here</a>. Also, see our replication of the tables from this CDISC pilot in our <a href="https://github.com/atorus-research/CDISC_pilot_replication">Github repository</a>.</em></p>
<p>Here’s how you would go about creating your <code>rtf_doc</code> object. (For more information about the functions being used here, see our <a href="https://atorus-research.github.io/advanced_usage.html">advanced usage</a> vignette)</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">doc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rtf_doc.html">rtf_doc</a></span>(<span class="no">ht</span>, <span class="kw">header_rows</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df</a></span>(
  <span class="kw">from.file</span><span class="kw">=</span><span class="st">'../data/titles.xlsx'</span>,
  <span class="kw">reader</span><span class="kw">=</span><span class="no">example_custom_reader</span>,
  <span class="kw">table_number</span><span class="kw">=</span><span class="st">'14-4.01'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/column_header_buffer.html">set_column_header_buffer</a></span>(<span class="kw">top</span><span class="kw">=</span><span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/font_size.html">set_font_size</a></span>(<span class="fl">10</span>)

<span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="no">doc</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"table16.rtf"</span>)</pre></body></html></div>
<p>Within the <code><a href="../reference/titles_and_footnotes_from_df.html">titles_and_footnotes_from_df()</a></code> function you can see the parameters used:</p>
<ul>
<li>
<code>from.file</code> is the location of our titles/footnotes</li>
<li>
<code>reader</code> is the function we created within this vignette</li>
<li>
<code>table_number</code> is the number of the table we are creating</li>
</ul>
<p>In the function call, <code>from.file</code> and <code>table_number</code> are passed forward into the custom reader. From there, validation of the incoming data frame happens, any missing variables have their defaults applied, and then <code><a href="../reference/add_titles_footnotes.html">add_titles()</a></code> and <code><a href="../reference/add_titles_footnotes.html">add_footnotes()</a></code> are called on the titles and footnotes within the data respectively. You can see in the resulting table that the titles and footnotes have been applied</p>
<p><img src="table16_img1.png" width="800px"></p>
<p>And there you have it. By using this process, the addition of titles and footnotes to your <code>rtf_doc</code> greatly simplifies, and this code becomes very reusable from program to program, allowing you to focus on the nuance of your table creation rather than the redundant application of creating titles and footnotes. As mentioned, it’s necessary to be able to manually specify your titles and footnotes as needed - but automating the process of applying them is much more desirable when your studies reach a certain scale.</p>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>If you have not already reviewed them, be sure to check out our other vignettes</p>
<ul>
<li>To pick up the basics of using pharmaRTF, see <code><a href="../articles/pharmaRTF.html">vignette("pharmaRTF")</a></code>
</li>
<li>To learn tips and tricks for using huxtable with pharmaRTF, see <code><a href="../articles/huxtable_tips.html">vignette("huxtable_tips")</a></code>
</li>
<li>To learn more advanced usage of pharmaRTF, see <code><a href="../articles/advanced_usage.html">vignette("advanced_usage")</a></code>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eli Miller, Ashley Tarasiewicz, Michael Stackhouse.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
